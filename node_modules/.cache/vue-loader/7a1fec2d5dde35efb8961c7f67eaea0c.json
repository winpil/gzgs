{"remainingRequest":"D:\\hzgs-admin\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\hzgs-admin\\src\\views\\pages\\devices\\block.vue?vue&type=style&index=0&id=42c943a6&lang=less&scoped=true&","dependencies":[{"path":"D:\\hzgs-admin\\src\\views\\pages\\devices\\block.vue","mtime":1620299676883},{"path":"D:\\hzgs-admin\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\hzgs-admin\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"D:\\hzgs-admin\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"D:\\hzgs-admin\\node_modules\\less-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\hzgs-admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\hzgs-admin\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgouZm9ybS1jb250YWluZXIgewogIC8vIG1hcmdpbi1sZWZ0OiA0MHB4OwogIC8vIG1hcmdpbi1yaWdodDogMTBweDsKICBtYXJnaW4tdG9wOiAzMHB4OwogIG1hcmdpbi1ib3R0b206IDIwcHg7Cn0KCi5mb3JtQmFyIHsKICBib3JkZXItYm90dG9tOiAxcHggc29saWQgI2RmZTZlYzsKICBvdmVyZmxvdzogaGlkZGVuOwoKICAuZmlsdGVyLWl0ZW0gewogICAgbWFyZ2luLWJvdHRvbTogMDsKICB9CgogIC5mb3JtLWhlYWQgewogICAgZm9udC1zaXplOiAyMHB4OwogICAgbWFyZ2luLXRvcDogMTBweDsKICAgIG1hcmdpbi1sZWZ0OiA2cHg7CiAgICBjb2xvcjogIzY2NjsKICAgIGRpc3BsYXk6IGlubGluZS1ibG9jazsKICB9Cn0KCi5wb3N0SW5mby1jb250YWluZXItaXRlbSB7CiAgbWluLXdpZHRoOiAyNTBweDsKfQoKLmZvcm0td3JhcHBlciB7CiAgYm9yZGVyOiAxcHggc29saWQgI2RmZTZlYzsKICBwYWRkaW5nLXRvcDogMzBweDsKICBib3JkZXItcmFkaXVzOiA1cHg7Cn0KCi5tZC1pbnB1dCB7CiAgbWFyZ2luLWJvdHRvbTogMjBweDsKICBtYXJnaW4tdG9wOiAtNDBweDsKICBtYXJnaW4tbGVmdDogMTVweDsKfQoKLmZpdC1wYWRkaW5nIHsKICBwYWRkaW5nLWxlZnQ6IDEwcHg7Cn0K"},{"version":3,"sources":["block.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAyLA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA","file":"block.vue","sourceRoot":"src/views/pages/devices","sourcesContent":["<template>\n    <div>   \n        <el-form ref=\"blockForm\" :model=\"blockForm\" :rules=\"blockRules\" class=\"form-container\">\n            <div class=\"createPost-main-container\">\n            <el-row>\n                <el-col :span=\"24\" class=\"form-wrapper\">\n                <div class=\"postInfo-container fit-padding\">\n                    <el-row style=\"white-space: nowrap;overflow: auto;\">\n                    <el-col :lg=\"5\" :md=\"8\">\n                        <el-form-item label-width=\"100px\" label=\"防区号:\" class=\"postInfo-container-item\" prop=\"smt_field\">\n                        <el-input v-model=\"blockForm.smt_field\" clearable :disabled=\"showFlag === pageType.detail || blockForm.status === 1 || blockForm.smt_field !== ''\" placeholder=\"请输入防区号\"></el-input>\n                        </el-form-item>\n                    </el-col>\n\n                    <el-col :lg=\"5\" :md=\"8\">\n                        <el-form-item label-width=\"100px\" label=\"选择线路:\" class=\"postInfo-container-item\" prop=\"zone\">\n                        <el-select v-model=\"blockForm.zone\" filterable default-first-option placeholder=\"请选择线路\" :disabled=\"showFlag === pageType.detail || blockForm.status === 1\">\n                            <el-option v-for=\"(item,index) in lineList\" :key=\"item.zone + index\" :label=\"item.name\" :value=\"item.zone\" />\n                        </el-select>\n                        </el-form-item>\n                    </el-col>\n\n                    <el-col :lg=\"5\" :md=\"8\">\n                        <el-form-item label-width=\"100px\" label=\"区间开始:\" class=\"postInfo-container-item\" prop=\"interval_start\">\n                        <el-input v-model=\"blockForm.interval_start\" clearable :disabled=\"showFlag === pageType.detail || blockForm.status === 1\" placeholder=\"区间开始值\"></el-input>\n                        </el-form-item>\n                    </el-col>\n\n                    <el-col :lg=\"5\" :md=\"8\">\n                        <el-form-item label-width=\"100px\" label=\"区间结束:\" class=\"postInfo-container-item\" prop=\"interval_end\">\n                        <el-input v-model=\"blockForm.interval_end\" clearable :disabled=\"showFlag === pageType.detail || blockForm.status === 1\" placeholder=\"区间结束值\"></el-input>\n                        </el-form-item>\n                    </el-col>\n\n                    <el-col :lg=\"4\" :md=\"8\" style=\"min-height: 1px;padding: 0 20px;\">\n                        <el-button @click=\"handleConfirm\" v-show=\"blockForm.status === 0\" style=\"margin-left: 10px;\">确认</el-button>\n                        <span></span>\n                        <el-button @click=\"handleUpdate\" v-show=\"blockForm.status === 1\" style=\"margin-left: 10px;\">修改</el-button>\n                        <el-button @click=\"handleDel\">删除</el-button>\n                    </el-col>\n                    </el-row>\n                </div>\n                </el-col>\n            </el-row>\n            </div>\n        </el-form>\n    </div>\n</template>\n\n<script>\nimport { createField, updateField } from '@/api/device/device.js'\nexport default {\n    data() {\n        return {\n            blockForm: {\n                smt_field: '',\n                zone: '',\n                interval_start: '',\n                interval_end: '',\n                smt_id: ''\n            },\n            blockRules: {\n                smt_field: [{ required: true, message: '请输入防区号', trigger: 'blur' }],\n                zone: [{ required: true, message: '请选择线路', trigger: 'change' }],\n                interval_start: [{ required: true, message: '请输入区间开始值', trigger: 'blur' }],\n                interval_end: [{ required: true, message: '请输入区间结束值', trigger: 'blur' }],\n            },\n            pageType: {\n                list: 0,\n                add: 1,\n                edit: 2,\n                detail: 3\n            },\n        }\n    },\n    props: {\n        showFlag: {\n            type: Number\n        },\n        block: {\n            type: Object\n        },\n        smtid: {\n            type: String\n        },\n        lineList: {\n            type: Array\n        }\n    },\n    methods: {\n        handleDel() {\n            let val = (this.blockForm.timeStamp == undefined || this.blockForm.timeStamp == '') ? this.blockForm.smt_field : this.blockForm.timeStamp\n            this.$confirm('防区删除后无法恢复，是否继续删除？', '提示', {\n                confirmButtonText: '提交',\n                cancelButtonText: '取消',\n                type: 'warning'\n            }).then(() => {\n                this.$emit('del', val)\n            }).catch((err) => {\n                console.log(err)\n            })\n        },\n        handleConfirm() {\n            let validTemp\n            this.$refs['blockForm'].validate((valid) => {\n                if (valid) {\n                validTemp = true\n                } else {\n                validTemp = false\n                return false;\n                }\n            });\n            if (!validTemp) return \n            console.log(this.showFlag)\n            if (this.showFlag === this.pageType.add) {\n                this.blockForm.status = 1\n                this.$emit('getBlock', this.blockForm)\n                this.$forceUpdate()\n            } else if (this.showFlag === this.pageType.edit) {\n                console.log(111, this.block.smt_field)\n                if (this.block.smt_field === '') {\n                    this.addField()\n                } else {\n                    this.updateField()\n                }\n            }\n            \n        },\n        handleUpdate() {\n            this.blockForm.status = 0\n            this.$forceUpdate()\n        },\n        addField() {\n            console.log('add', this.smtid)\n            let params = {}\n            params.interval_start = this.blockForm.interval_start\n            params.interval_end = this.blockForm.interval_end\n            params.zone = this.blockForm.zone\n            params.smt_id = this.smtid\n            params.smt_field = this.blockForm.smt_field\n            createField(params).then(res => {\n                if (res.retcode === 200) {\n                    this.$message({ type: 'success', message: '新增防区成功！' })\n                    this.blockForm.status = 1\n                    this.$emit('getBlock', this.blockForm)\n                    this.$forceUpdate()\n                } else{\n                    this.$message({ type: 'warning', message: '新增防区失败，请输入防区号唯一！' })\n                }\n            })\n        },\n        updateField() {\n            console.log('update', this.smtid)\n            let params = {}\n            params.interval_start = this.blockForm.interval_start\n            params.interval_end = this.blockForm.interval_end\n            params.zone = this.blockForm.zone\n            params.smt_id = this.smtid\n            params.smt_field = this.blockForm.smt_field\n            updateField(params).then(res => {\n                if (res.retcode === 200) {\n                    this.$message({ type: 'success', message: '修改防区成功！' })\n                    this.blockForm.status = 1\n                    this.$emit('getBlock', this.blockForm)\n                    this.$forceUpdate()\n                } else{\n                    this.$message({ type: 'warning', message: '修改防区失败！' })\n                }\n            })\n        }\n    },\n    mounted() {\n        this.blockForm = JSON.parse(JSON.stringify(this.block))\n        \n        if (this.blockForm.status != 0 && this.blockForm.status != 1) {\n            this.blockForm.status = 0\n            this.$forceUpdate()\n        }\n        this.$refs.blockForm.resetFields()\n        console.log(this.blockForm)\n    }\n}\n</script>\n\n<style lang=\"less\" scoped>\n  .form-container {\n    // margin-left: 40px;\n    // margin-right: 10px;\n    margin-top: 30px;\n    margin-bottom: 20px;\n  }\n\n  .formBar {\n    border-bottom: 1px solid #dfe6ec;\n    overflow: hidden;\n\n    .filter-item {\n      margin-bottom: 0;\n    }\n\n    .form-head {\n      font-size: 20px;\n      margin-top: 10px;\n      margin-left: 6px;\n      color: #666;\n      display: inline-block;\n    }\n  }\n\n  .postInfo-container-item {\n    min-width: 250px;\n  }\n\n  .form-wrapper {\n    border: 1px solid #dfe6ec;\n    padding-top: 30px;\n    border-radius: 5px;\n  }\n\n  .md-input {\n    margin-bottom: 20px;\n    margin-top: -40px;\n    margin-left: 15px;\n  }\n\n  .fit-padding {\n    padding-left: 10px;\n  }\n</style>"]}]}
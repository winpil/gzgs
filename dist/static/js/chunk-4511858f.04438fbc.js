(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4511858f"],{"023f":function(t,e,i){"use strict";i.d(e,"a",(function(){return s})),i.d(e,"i",(function(){return o})),i.d(e,"l",(function(){return n})),i.d(e,"e",(function(){return l})),i.d(e,"b",(function(){return r})),i.d(e,"j",(function(){return c})),i.d(e,"m",(function(){return d})),i.d(e,"f",(function(){return u})),i.d(e,"c",(function(){return m})),i.d(e,"n",(function(){return p})),i.d(e,"g",(function(){return h})),i.d(e,"d",(function(){return f})),i.d(e,"o",(function(){return g})),i.d(e,"k",(function(){return b})),i.d(e,"h",(function(){return v}));var a=i("b775");function s(t){return Object(a["a"])({url:"/api/v1/device_gt_add/",method:"post",data:t})}function o(t){return Object(a["a"])({url:"/api/v1/device_gt_list/",method:"get",params:t})}function n(t){return Object(a["a"])({url:"/api/v1/device_gt_set/",method:"put",params:t})}function l(t){return Object(a["a"])({url:"/api/v1/device_gt_delete/",method:"delete",params:t})}function r(t){return Object(a["a"])({url:"/api/v1/device_smt_add/",method:"POST",data:t})}function c(t){return Object(a["a"])({url:"/api/v1/device_smt_list/",method:"get",params:t})}function d(t){return Object(a["a"])({url:"/api/v1/device_smt_set/",method:"put",data:t})}function u(t){return Object(a["a"])({url:"/api/v1/device_smt_delete/",method:"delete",params:t})}function m(t){return Object(a["a"])({url:"/api/v1/field_add/",method:"POST",data:t})}function p(t){return Object(a["a"])({url:"/api/v1/change_field/",method:"put",data:t})}function h(t){return Object(a["a"])({url:"/api/v1/change_field/",method:"delete",params:t})}function f(t){return Object(a["a"])({url:"/api/v1/node_set/",method:"POST",data:t})}function g(t){return Object(a["a"])({url:"/api/v1/node_set/",method:"PUT",data:t})}function b(t){return Object(a["a"])({url:"/api/v1/node_set/",method:"GET",params:t})}function v(t){return Object(a["a"])({url:"/api/v1/node_set/",method:"DELETE",params:t})}},"09f4":function(t,e,i){"use strict";i.d(e,"a",(function(){return n})),Math.easeInOutQuad=function(t,e,i,a){return t/=a/2,t<1?i/2*t*t+e:(t--,-i/2*(t*(t-2)-1)+e)};var a=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)}}();function s(t){document.documentElement.scrollTop=t,document.body.parentNode.scrollTop=t,document.body.scrollTop=t}function o(){return document.documentElement.scrollTop||document.body.parentNode.scrollTop||document.body.scrollTop}function n(t,e,i){var n=o(),l=t-n,r=20,c=0;e="undefined"===typeof e?500:e;var d=function t(){c+=r;var o=Math.easeInOutQuad(c,n,l,e);s(o),c<e?a(t):i&&"function"===typeof i&&i()};d()}},"1c47":function(t,e,i){"use strict";var a=i("41b8"),s=i.n(a);s.a},"41b8":function(t,e,i){},5044:function(t,e,i){"use strict";i.d(e,"a",(function(){return s}));var a=i("b775");function s(){return Object(a["a"])({url:"/qiniu/upload/token",method:"get"})}},"57c1":function(t,e,i){"use strict";var a=i("f901"),s=i.n(a);s.a},6724:function(t,e,i){"use strict";i("8d41");var a="@@wavesContext";function s(t,e){function i(i){var a=Object.assign({},e.value),s=Object.assign({ele:t,type:"hit",color:"rgba(0, 0, 0, 0.15)"},a),o=s.ele;if(o){o.style.position="relative",o.style.overflow="hidden";var n=o.getBoundingClientRect(),l=o.querySelector(".waves-ripple");switch(l?l.className="waves-ripple":(l=document.createElement("span"),l.className="waves-ripple",l.style.height=l.style.width=Math.max(n.width,n.height)+"px",o.appendChild(l)),s.type){case"center":l.style.top=n.height/2-l.offsetHeight/2+"px",l.style.left=n.width/2-l.offsetWidth/2+"px";break;default:l.style.top=(i.pageY-n.top-l.offsetHeight/2-document.documentElement.scrollTop||document.body.scrollTop)+"px",l.style.left=(i.pageX-n.left-l.offsetWidth/2-document.documentElement.scrollLeft||document.body.scrollLeft)+"px"}return l.style.backgroundColor=s.color,l.className="waves-ripple z-active",!1}}return t[a]?t[a].removeHandle=i:t[a]={removeHandle:i},i}var o={bind:function(t,e){t.addEventListener("click",s(t,e),!1)},update:function(t,e){t.removeEventListener("click",t[a].removeHandle,!1),t.addEventListener("click",s(t,e),!1)},unbind:function(t){t.removeEventListener("click",t[a].removeHandle,!1),t[a]=null,delete t[a]}},n=function(t){t.directive("waves",o)};window.Vue&&(window.waves=o,Vue.use(n)),o.install=n;e["a"]=o},"8ba9":function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"app-container"},[t.showFlag===t.pageType.list?i("div",[i("div",{staticClass:"filter-container"},[i("el-input",{staticClass:"filter-item",staticStyle:{width:"300px","margin-right":"10px"},attrs:{clearable:"",placeholder:"设备号/区域/设备代号"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.handleFilter(e)}}}),i("el-button",{staticClass:"filter-item",staticStyle:{"margin-left":"10px",float:"right","margin-right":"10px"},attrs:{type:"primary",icon:"el-icon-edit"},on:{click:t.handleCreate}},[t._v(" "+t._s(t.$t("table.add"))+" ")]),i("el-button",{directives:[{name:"waves",rawName:"v-waves"}],staticClass:"filter-item",staticStyle:{float:"right"},attrs:{type:"primary",icon:"el-icon-search"},on:{click:t.handleFilter}},[t._v(" "+t._s(t.$t("table.search"))+" ")])],1),i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoading,expression:"listLoading"}],key:t.tableKey,staticStyle:{width:"100%"},attrs:{data:t.list,border:"",fit:"","highlight-current-row":""}},[i("el-table-column",{attrs:{type:"expand"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-table",{staticStyle:{width:"calc(100% - 47px)"},attrs:{data:e.row.fields,border:""}},[i("el-table-column",{attrs:{type:"index",width:"180",align:"center",label:"序号"}}),i("el-table-column",{attrs:{prop:"field_id",width:"200",align:"center",label:"防区代码"}}),i("el-table-column",{attrs:{prop:"smt_field",width:"200",align:"center",label:"防区号"}}),i("el-table-column",{attrs:{prop:"interval_start",width:"200",align:"center",label:"区间开始值"}}),i("el-table-column",{attrs:{prop:"interval_end",width:"200",align:"center",label:"区间结束值"}}),i("el-table-column",{attrs:{prop:"zone","min-width":"250",align:"center",label:"所属责任区"}}),i("el-table-column",{attrs:{fixed:"right",label:t.$t("table.actions"),align:"center",width:"151","class-name":"small-padding fixed-width"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.row;return[i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){return t.handleNode(a)}}},[t._v(" 节点信息 ")])]}}],null,!0)})],1)]}}],null,!1,2673844948)}),i("el-table-column",{attrs:{label:"ID",type:"index",align:"center",width:"80"}}),i("el-table-column",{attrs:{label:"SMT设备号",width:"200px",align:"center",prop:"smt_id"}}),i("el-table-column",{attrs:{label:"关联GT设备号",width:"200px",align:"center",prop:"gt_id"}}),i("el-table-column",{attrs:{label:"名称代号",width:"200px",align:"center",prop:"name"}}),i("el-table-column",{attrs:{label:"设备GPS经度",width:"200px",align:"center",prop:"longitude"}}),i("el-table-column",{attrs:{label:"设备GPS纬度",width:"200px",align:"center",prop:"latitude"}}),i("el-table-column",{attrs:{label:"设备所属区域","min-width":"250px",align:"center",prop:"area_name"}}),i("el-table-column",{attrs:{fixed:"right",label:t.$t("table.actions"),align:"center",width:"250","class-name":"small-padding fixed-width"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.row,s=e.$index;return[i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){return t.handleUpdate(a)}}},[t._v(" "+t._s(t.$t("table.edit"))+" ")]),i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){return t.handleDetail(a)}}},[t._v(" 详情 ")]),i("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(e){return t.handleDelete(a,s)}}},[t._v(" "+t._s(t.$t("table.delete"))+" ")])]}}],null,!1,1007551280)})],1),i("pagination",{directives:[{name:"show",rawName:"v-show",value:t.total>0,expression:"total>0"}],attrs:{total:t.total,page:t.queryForm.page,limit:t.queryForm.limit},on:{"update:page":function(e){return t.$set(t.queryForm,"page",e)},"update:limit":function(e){return t.$set(t.queryForm,"limit",e)},pagination:t.getList}})],1):t.showFlag===t.pageType.add||t.showFlag===t.pageType.edit||t.showFlag===t.pageType.detail?i("div",[i("div",{staticClass:"filter-container formBar"},[i("div",{staticClass:"form-head"},[t._v(" "+t._s(t.headName)+" ")]),i("el-button",{staticClass:"filter-item",staticStyle:{"margin-left":"10px",float:"right","margin-right":"10px"},attrs:{type:"primary",icon:"el-icon-back"},on:{click:t.handleReturn}},[t._v(" 返回 ")]),t.showFlag!==t.pageType.detail?i("el-button",{staticClass:"filter-item",staticStyle:{"margin-left":"10px",float:"right"},attrs:{type:"primary",icon:"el-icon-refresh-right"},on:{click:t.handleReset}},[t._v(" 重置 ")]):t._e(),t.showFlag!==t.pageType.detail?i("el-button",{directives:[{name:"waves",rawName:"v-waves"}],staticClass:"filter-item",staticStyle:{float:"right"},attrs:{type:"primary",icon:"el-icon-document-checked"},on:{click:t.handleSubmit}},[t._v(" 提交 ")]):t._e()],1),i("el-form",{ref:"postForm",staticClass:"form-container",attrs:{model:t.postForm,rules:t.postRules}},[i("div",{staticClass:"createPost-main-container"},[i("el-row",[i("el-col",{staticClass:"form-wrapper",attrs:{span:24}},[i("el-row",{staticClass:"fit-padding"},[i("el-col",{attrs:{span:18}},[i("el-form-item",{staticClass:"md-input",attrs:{prop:"smt_id"}},[i("MDinput",{attrs:{maxlength:100,name:"name",required:"",disabled:t.showFlag!==t.pageType.add},model:{value:t.postForm.smt_id,callback:function(e){t.$set(t.postForm,"smt_id",e)},expression:"postForm.smt_id"}},[t._v(" "+t._s(t.mdcontent)+" ")])],1)],1),i("el-col",{attrs:{span:6}})],1),i("div",{staticClass:"postInfo-container fit-padding"},[i("el-row",[i("el-col",{attrs:{span:8}},[i("el-form-item",{staticClass:"postInfo-container-item",attrs:{"label-width":"90px",label:"名称代号:",prop:"name"}},[i("el-input",{staticStyle:{"min-width":"120px"},attrs:{placeholder:"请输入名称代号",clearable:"",disabled:t.showFlag===t.pageType.detail},model:{value:t.postForm.name,callback:function(e){t.$set(t.postForm,"name",e)},expression:"postForm.name"}})],1)],1),i("el-col",{attrs:{span:10}},[i("el-form-item",{staticClass:"postInfo-container-item",attrs:{"label-width":"120px",label:"选择区域:",prop:"area_id"}},[i("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"","default-first-option":"",placeholder:"请选择区域",disabled:t.showFlag===t.pageType.detail},model:{value:t.postForm.area_id,callback:function(e){t.$set(t.postForm,"area_id",e)},expression:"postForm.area_id"}},t._l(t.areaList,(function(t){return i("el-option",{key:t.area_id,attrs:{label:t.area_name,value:t.area_id}})})),1)],1)],1),i("el-col",{staticStyle:{"min-height":"1px"},attrs:{span:6}})],1),i("el-row",[i("el-col",{attrs:{span:8}},[i("el-form-item",{staticClass:"postInfo-container-item",attrs:{"label-width":"90px",label:"GT设备:",prop:"gt_id"}},[i("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"","default-first-option":"",placeholder:"请选择GT设备",disabled:t.showFlag===t.pageType.detail},model:{value:t.postForm.gt_id,callback:function(e){t.$set(t.postForm,"gt_id",e)},expression:"postForm.gt_id"}},t._l(t.gtList,(function(t){return i("el-option",{key:t.gt_id,attrs:{label:t.name,value:t.gt_id}})})),1)],1)],1),i("el-col",{attrs:{span:10}},[i("el-form-item",{staticClass:"postInfo-container-item",staticStyle:{"white-space":"nowrap"},attrs:{"label-width":"120px",label:"GPS信息:"}},[i("el-form-item",{staticStyle:{display:"inline-block","min-width":"125px",width:"49%","margin-right":"2%"},attrs:{"label-width":"0px",prop:"longitude"}},[i("el-input",{staticStyle:{display:"inline-block",width:"100%","margin-right":"10px"},attrs:{clearable:"",disabled:t.showFlag===t.pageType.detail,placeholder:"请输入经度"},model:{value:t.postForm.longitude,callback:function(e){t.$set(t.postForm,"longitude",e)},expression:"postForm.longitude"}})],1),i("el-form-item",{staticStyle:{display:"inline-block","min-width":"125px",width:"49%"},attrs:{"label-width":"0px",prop:"latitude"}},[i("el-input",{staticStyle:{display:"inline-block",width:"100%"},attrs:{clearable:"",disabled:t.showFlag===t.pageType.detail,placeholder:"请输入纬度"},model:{value:t.postForm.latitude,callback:function(e){t.$set(t.postForm,"latitude",e)},expression:"postForm.latitude"}})],1)],1)],1),i("el-col",{staticStyle:{"min-height":"1px"},attrs:{span:6}})],1)],1)],1)],1)],1)]),i("div",{staticClass:"filter-container formBar"},[i("div",{staticClass:"form-head"},[t._v(" 防区信息 ")]),t.showFlag!==t.pageType.detail?i("el-button",{directives:[{name:"waves",rawName:"v-waves"}],staticClass:"filter-item",staticStyle:{float:"right","margin-right":"10px"},attrs:{type:"primary",icon:"el-icon-document-checked"},on:{click:t.handleAddBlock}},[t._v(" 添加防区 ")]):t._e()],1),0!==this.blockList.length?i("div",{staticClass:"block-wrapper"},t._l(t.blockList,(function(e){return i("div",{key:e.field_id+"-"+e.timeStamp,staticStyle:{"margin-bottom":"10px"}},[i("Block",{attrs:{block:e,lineList:t.lineList,showFlag:t.showFlag,smtid:t.postForm.smt_id},on:{del:t.handleDelBlock,getBlock:t.handleGetBlock}})],1)})),0):i("div",{staticClass:"block-info"},[t._v(" 暂无防区信息 ")])],1):t.showFlag===t.pageType.node?i("div",[i("div",{staticClass:"filter-container formBar"},[i("div",{staticClass:"form-head"},[t._v(" 节点信息 ")]),i("el-button",{staticClass:"filter-item",staticStyle:{"margin-left":"10px",float:"right","margin-right":"10px"},attrs:{type:"primary",icon:"el-icon-back"},on:{click:t.handleReturn}},[t._v(" 返回 ")]),t.showFlag!==t.pageType.detail?i("el-button",{directives:[{name:"waves",rawName:"v-waves"}],staticClass:"filter-item",staticStyle:{float:"right"},attrs:{type:"primary",icon:"el-icon-document-checked"},on:{click:t.handleAddNode}},[t._v(" 添加节点 ")]):t._e()],1),0!==this.nodeList.length?i("div",{staticClass:"block-wrapper"},t._l(t.nodeList,(function(e){return i("div",{key:e.id},[i("NodeComp",{attrs:{block:e,lineList:t.lineList,showFlag:t.showFlag,smtid:t.postForm.smt_id},on:{del:t.handleDelNode,getNode:t.handleGetNode}})],1)})),0):i("div",{staticClass:"block-info"},[t._v(" 暂无防区信息 ")])]):t._e()])},s=[],o=(i("4160"),i("a434"),i("b0c0"),i("b64b"),i("159b"),i("023f")),n=i("8d36"),l=i("fdda"),r=i("6724"),c=(i("ed08"),i("333d")),d=i("8256"),u=(i("70a2"),i("1aba")),m=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("el-form",{ref:"blockForm",staticClass:"form-container",attrs:{model:t.blockForm,rules:t.blockRules}},[i("div",{staticClass:"createPost-main-container"},[i("el-row",[i("el-col",{staticClass:"form-wrapper",attrs:{span:24}},[i("div",{staticClass:"postInfo-container fit-padding"},[i("el-row",{staticStyle:{"white-space":"nowrap",overflow:"auto"}},[i("el-col",{attrs:{lg:5,md:8}},[i("el-form-item",{staticClass:"postInfo-container-item",attrs:{"label-width":"100px",label:"防区号:",prop:"smt_field"}},[i("el-input",{attrs:{clearable:"",disabled:t.showFlag===t.pageType.detail||1===t.blockForm.status||""!==t.blockForm.smt_field,placeholder:"请输入防区号"},model:{value:t.blockForm.smt_field,callback:function(e){t.$set(t.blockForm,"smt_field",e)},expression:"blockForm.smt_field"}})],1)],1),i("el-col",{attrs:{lg:5,md:8}},[i("el-form-item",{staticClass:"postInfo-container-item",attrs:{"label-width":"100px",label:"选择线路:",prop:"zone"}},[i("el-select",{attrs:{filterable:"","default-first-option":"",placeholder:"请选择线路",disabled:t.showFlag===t.pageType.detail||1===t.blockForm.status},model:{value:t.blockForm.zone,callback:function(e){t.$set(t.blockForm,"zone",e)},expression:"blockForm.zone"}},t._l(t.lineList,(function(t,e){return i("el-option",{key:t.zone+e,attrs:{label:t.name,value:t.zone}})})),1)],1)],1),i("el-col",{attrs:{lg:5,md:8}},[i("el-form-item",{staticClass:"postInfo-container-item",attrs:{"label-width":"100px",label:"区间开始:",prop:"interval_start"}},[i("el-input",{attrs:{clearable:"",disabled:t.showFlag===t.pageType.detail||1===t.blockForm.status,placeholder:"区间开始值"},model:{value:t.blockForm.interval_start,callback:function(e){t.$set(t.blockForm,"interval_start",e)},expression:"blockForm.interval_start"}})],1)],1),i("el-col",{attrs:{lg:5,md:8}},[i("el-form-item",{staticClass:"postInfo-container-item",attrs:{"label-width":"100px",label:"区间结束:",prop:"interval_end"}},[i("el-input",{attrs:{clearable:"",disabled:t.showFlag===t.pageType.detail||1===t.blockForm.status,placeholder:"区间结束值"},model:{value:t.blockForm.interval_end,callback:function(e){t.$set(t.blockForm,"interval_end",e)},expression:"blockForm.interval_end"}})],1)],1),i("el-col",{staticStyle:{"min-height":"1px",padding:"0 20px"},attrs:{lg:4,md:8}},[i("el-button",{directives:[{name:"show",rawName:"v-show",value:0===t.blockForm.status,expression:"blockForm.status === 0"}],staticStyle:{"margin-left":"10px"},on:{click:t.handleConfirm}},[t._v("确认")]),i("span"),i("el-button",{directives:[{name:"show",rawName:"v-show",value:1===t.blockForm.status,expression:"blockForm.status === 1"}],staticStyle:{"margin-left":"10px"},on:{click:t.handleUpdate}},[t._v("修改")]),i("el-button",{on:{click:t.handleDel}},[t._v("删除")])],1)],1)],1)])],1)],1)])],1)},p=[],h=(i("a9e3"),{data:function(){return{blockForm:{smt_field:"",zone:"",interval_start:"",interval_end:"",smt_id:""},blockRules:{smt_field:[{required:!0,message:"请输入防区号",trigger:"blur"}],zone:[{required:!0,message:"请选择线路",trigger:"change"}],interval_start:[{required:!0,message:"请输入区间开始值",trigger:"blur"}],interval_end:[{required:!0,message:"请输入区间结束值",trigger:"blur"}]},pageType:{list:0,add:1,edit:2,detail:3}}},props:{showFlag:{type:Number},block:{type:Object},smtid:{type:String},lineList:{type:Array}},methods:{handleDel:function(){var t=this,e=void 0==this.blockForm.timeStamp||""==this.blockForm.timeStamp?this.blockForm.smt_field:this.blockForm.timeStamp;this.$confirm("防区删除后无法恢复，是否继续删除？","提示",{confirmButtonText:"提交",cancelButtonText:"取消",type:"warning"}).then((function(){t.$emit("del",e)})).catch((function(t){console.log(t)}))},handleConfirm:function(){var t;this.$refs["blockForm"].validate((function(e){if(!e)return t=!1,!1;t=!0})),t&&(console.log(this.showFlag),this.showFlag===this.pageType.add?(this.blockForm.status=1,this.$emit("getBlock",this.blockForm),this.$forceUpdate()):this.showFlag===this.pageType.edit&&(console.log(111,this.block.smt_field),""===this.block.smt_field?this.addField():this.updateField()))},handleUpdate:function(){this.blockForm.status=0,this.$forceUpdate()},addField:function(){var t=this;console.log("add",this.smtid);var e={};e.interval_start=this.blockForm.interval_start,e.interval_end=this.blockForm.interval_end,e.zone=this.blockForm.zone,e.smt_id=this.smtid,e.smt_field=this.blockForm.smt_field,Object(o["c"])(e).then((function(e){200===e.retcode?(t.$message({type:"success",message:"新增防区成功！"}),t.blockForm.status=1,t.$emit("getBlock",t.blockForm),t.$forceUpdate()):t.$message({type:"warning",message:"新增防区失败，请输入防区号唯一！"})}))},updateField:function(){var t=this;console.log("update",this.smtid);var e={};e.interval_start=this.blockForm.interval_start,e.interval_end=this.blockForm.interval_end,e.zone=this.blockForm.zone,e.smt_id=this.smtid,e.smt_field=this.blockForm.smt_field,Object(o["n"])(e).then((function(e){200===e.retcode?(t.$message({type:"success",message:"修改防区成功！"}),t.blockForm.status=1,t.$emit("getBlock",t.blockForm),t.$forceUpdate()):t.$message({type:"warning",message:"修改防区失败！"})}))}},mounted:function(){this.blockForm=JSON.parse(JSON.stringify(this.block)),0!=this.blockForm.status&&1!=this.blockForm.status&&(this.blockForm.status=0,this.$forceUpdate()),this.$refs.blockForm.resetFields(),console.log(this.blockForm)}}),f=h,g=(i("aa5f"),i("2877")),b=Object(g["a"])(f,m,p,!1,null,"41d3c0ef",null),v=b.exports,F=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("el-form",{ref:"nodeForm",staticClass:"form-container",attrs:{model:t.nodeForm,rules:t.nodeRules}},[i("div",{staticClass:"createPost-main-container"},[i("el-row",[i("el-col",{staticClass:"form-wrapper",attrs:{span:24}},[i("div",{staticClass:"postInfo-container fit-padding"},[i("el-row",{staticStyle:{"white-space":"nowrap",overflow:"auto"}},[i("el-col",{attrs:{lg:6,md:8}},[i("el-form-item",{staticClass:"postInfo-container-item",attrs:{"label-width":"100px",label:"序号:",prop:"order"}},[i("el-input",{attrs:{clearable:"",placeholder:"请输入防区号",disabled:t.showFlag===t.pageType.detail||1===t.nodeForm.status},model:{value:t.nodeForm.order,callback:function(e){t.$set(t.nodeForm,"order",e)},expression:"nodeForm.order"}})],1)],1),i("el-col",{attrs:{lg:7,md:8}},[i("el-form-item",{staticClass:"postInfo-container-item",attrs:{"label-width":"100px",label:"经度:",prop:"longitude"}},[i("el-input",{attrs:{clearable:"",disabled:t.showFlag===t.pageType.detail||1===t.nodeForm.status,placeholder:"请输入经度"},model:{value:t.nodeForm.longitude,callback:function(e){t.$set(t.nodeForm,"longitude",e)},expression:"nodeForm.longitude"}})],1)],1),i("el-col",{attrs:{lg:7,md:8}},[i("el-form-item",{staticClass:"postInfo-container-item",attrs:{"label-width":"100px",label:"纬度:",prop:"latitude"}},[i("el-input",{attrs:{clearable:"",disabled:t.showFlag===t.pageType.detail||1===t.nodeForm.status,placeholder:"请输入纬度"},model:{value:t.nodeForm.latitude,callback:function(e){t.$set(t.nodeForm,"latitude",e)},expression:"nodeForm.latitude"}})],1)],1),i("el-col",{staticStyle:{"min-height":"1px",padding:"0 20px"},attrs:{lg:4,md:8}},[i("el-button",{directives:[{name:"show",rawName:"v-show",value:0===t.nodeForm.status,expression:"nodeForm.status === 0"}],staticStyle:{"margin-left":"10px"},on:{click:t.handleConfirm}},[t._v("确认")]),i("span"),i("el-button",{directives:[{name:"show",rawName:"v-show",value:1===t.nodeForm.status,expression:"nodeForm.status === 1"}],staticStyle:{"margin-left":"10px"},on:{click:t.handleUpdate}},[t._v("修改")]),i("el-button",{on:{click:t.handleDel}},[t._v("删除")])],1)],1)],1)])],1)],1)])],1)},w=[],_={data:function(){return{nodeForm:{order:"",longitude:"",latitude:"",status:""},nodeRules:{order:[{required:!0,message:"请输入序号",trigger:"blur"}],longitude:[{required:!0,message:"请输入经度",trigger:"blur"}],latitude:[{required:!0,message:"请输入纬度",trigger:"blur"}]},pageType:{list:0,add:1,edit:2,detail:3}}},props:{showFlag:{type:Number},block:{type:Object},smtid:{type:String}},methods:{handleDel:function(){var t=this,e=this.nodeForm.id||"";this.$confirm("节点删除后无法恢复，是否继续删除？","提示",{confirmButtonText:"提交",cancelButtonText:"取消",type:"warning"}).then((function(){t.$emit("del",e)})).catch((function(t){console.log(t)}))},handleConfirm:function(){var t;this.$refs["nodeForm"].validate((function(e){if(!e)return t=!1,!1;t=!0})),t&&(this.nodeForm.status=1,this.$emit("getNode",this.nodeForm),this.$forceUpdate())},handleUpdate:function(){this.nodeForm.status=0,this.$forceUpdate()},addField:function(){var t=this;console.log("add",this.smtid);var e={};e.interval_start=this.nodeForm.interval_start,e.interval_end=this.nodeForm.interval_end,e.zone=this.nodeForm.zone,e.smt_id=this.smtid,e.smt_field=this.nodeForm.smt_field,Object(o["c"])(e).then((function(e){200===e.retcode?(t.$message({type:"success",message:"新增防区成功！"}),t.nodeForm.status=1,t.$emit("getBlock",t.nodeForm),t.$forceUpdate()):t.$message({type:"warning",message:"新增防区失败，请输入防区号唯一！"})}))},updateField:function(){var t=this;console.log("update",this.smtid);var e={};e.interval_start=this.nodeForm.interval_start,e.interval_end=this.nodeForm.interval_end,e.zone=this.nodeForm.zone,e.smt_id=this.smtid,e.smt_field=this.nodeForm.smt_field,Object(o["n"])(e).then((function(e){200===e.retcode?(t.$message({type:"success",message:"修改防区成功！"}),t.nodeForm.status=1,t.$emit("getBlock",t.nodeForm),t.$forceUpdate()):t.$message({type:"warning",message:"修改防区失败！"})}))}},mounted:function(){this.nodeForm=JSON.parse(JSON.stringify(this.block)),0!=this.nodeForm.status&&1!=this.nodeForm.status&&(this.nodeForm.status=0,this.$forceUpdate()),this.$refs.nodeForm.resetFields(),console.log(this.nodeForm)}},y=_,k=(i("1c47"),Object(g["a"])(y,F,w,!1,null,"20660652",null)),x=k.exports,L={name:"ComplexTable",components:{Tinymce:d["a"],MDinput:u["a"],Pagination:c["a"],Block:v,NodeComp:x},directives:{waves:r["a"]},filters:{statusFilter:function(t){var e={published:"success",draft:"info",deleted:"danger"};return e[t]},typeFilter:function(t){return calendarTypeKeyValue[t]}},data:function(){return{tableKey:0,list:null,total:0,listLoading:!0,postRules:{name:[{required:!0,message:"请输入名称代号",trigger:"blur"}],area_id:[{required:!0,message:"请选择区域",trigger:"change"}],gt_id:[{required:!0,message:"请选择gt设备",trigger:"change"}],smt_id:[{required:!0,message:"请输入设备号",trigger:"blur"}],longitude:[{required:!0,message:"请输入设备经度",trigger:"blur"}],latitude:[{required:!0,message:"请输入设备纬度",trigger:"blur"}]},showFlag:0,nodeList:[],pageType:{list:0,add:1,edit:2,detail:3,node:4},queryForm:{page:1,limit:15},postForm:{smt_id:"",gt_id:"",area_id:"",name:"",longitude:"",latitude:"",fields:[]},areaList:[],gtList:[],currentRow:{},blockList:[],lineList:[]}},created:function(){this.getList(),this.getAreaList(),this.getGtList(),this.getLineList()},computed:{mdcontent:function(){var t=""==this.postForm.smt_id?"请输入设备号:":"设备号:";return t},headName:function(){var t=this.showFlag===this.pageType.add?"新增SMT设备":this.showFlag===this.pageType.edit?"编辑SMT设备":"SMT设备详情";return t}},methods:{getList:function(){var t=this;this.listLoading=!0,Object(o["j"])(this.queryForm).then((function(e){200===e.retcode&&(t.list=e.result,t.list&&t.list.length>0&&(t.total=t.list.length)),setTimeout((function(){t.listLoading=!1}),1e3)}))},getAreaList:function(){var t=this;Object(n["c"])({page:1,limit:1e3}).then((function(e){200==e.retcode&&(t.areaList=e.result,t.list&&t.list.length>0&&(t.total=t.list.length))}))},getLineList:function(){var t=this;Object(l["c"])({page:1,limit:1e3}).then((function(e){200==e.retcode&&(t.lineList=e.result,t.list&&t.list.length>0&&(t.total=t.list.length))}))},getGtList:function(){var t=this;Object(o["i"])({page:1,limit:1e3}).then((function(e){200==e.retcode&&(t.gtList=e.result,t.list&&t.list.length>0&&(t.total=t.list.length))}))},handleFilter:function(){this.getList()},judgeObjHasNull:function(t){var e=!1;return Object.keys(t).forEach((function(i,a){""===t[i]&&(e=!0)})),e},handleCreate:function(){this.showFlag=this.pageType.add,this.currentRow={},this.blockList=[],this.handleReset()},handleReturn:function(){var t=this;this.showFlag=this.pageType.list,this.currentRow={},this.blockList=[],this.$nextTick((function(){t.getList()}))},handleReset:function(){var t=this;Object.keys(this.postForm).forEach((function(e){t.postForm[e]=t.currentRow[e]})),this.showFlag===this.pageType.add?this.blockList=[]:this.blockList=this.currentRow.fields,this.$nextTick((function(){t.$refs.postForm.resetFields()}))},handleSubmit:function(){var t=this,e=[];if(this.blockList.forEach((function(i,a){t.judgeObjHasNull(i)&&e.push(a)})),0!==e.length&&this.$confirm("该设备存在未确认的防区，是否继续提交？","提示",{confirmButtonText:"提交",cancelButtonText:"取消",type:"warning"}).then((function(){e.forEach((function(e){t.blockList.splice(e,1)}))})).catch((function(t){console.log(t)})),this.postForm.fields=this.blockList||[],this.showFlag===this.pageType.add)Object(o["b"])(this.postForm).then((function(e){200===e.retcode?(t.$message({type:"success",message:"提交成功！"}),t.handleReturn()):t.$message({type:"warning",message:"提交失败！".concat(e.status)})}));else{var i={};i.smt_id=this.postForm.smt_id,i.area_id=this.postForm.area_id,i.name=this.postForm.name,i.gt_id=this.postForm.gt_id,i.name=this.postForm.name,i.longitude=this.postForm.longitude,i.latitude=this.postForm.latitude,i.fields=this.postForm.fields,Object(o["m"])(i).then((function(e){200===e.retcode?(t.$message({type:"success",message:"提交成功！"}),t.handleReturn()):t.$message({type:"warning",message:"提交失败！".concat(e.status)})}))}this.postForm.fields=this.blockList,console.log(this.postForm)},handleUpdate:function(t){var e=this;this.showFlag=this.pageType.edit,t.fields.forEach((function(t){t.status=1})),this.currentRow=JSON.parse(JSON.stringify(t)),console.log("this.currentRow",this.currentRow),Object.keys(t).forEach((function(i){e.postForm[i]=t[i]})),this.blockList=this.postForm.fields},handleDetail:function(t){var e=this;this.showFlag=this.pageType.detail,Object.keys(this.postForm).forEach((function(i){e.postForm[i]=t[i]}))},handleDelete:function(t){var e=this;this.$confirm("设备删除后将不可恢复，确认删除该设备？","提示",{confirmButtonText:"删除",cancelButtonText:"取消",type:"warning"}).then((function(){Object(o["f"])({smt_id:t.smt_id}).then((function(t){200===t.retcode?(e.$message({type:"success",message:"删除成功！"}),setTimeout((function(){e.getList()}),200)):e.$message({type:"warning",message:"删除失败,".concat(t.status)})}))})).catch((function(t){console.log(t)}))},getNodeList:function(){var t=this;Object(o["k"])({field_id:this.currentField.field_id}).then((function(e){200==e.retcode&&(t.nodeList=e.result||[],t.nodeList.length>0&&t.nodeList.forEach((function(t){t.status=1})))}))},handleAddNode:function(){var t=!0;if(this.nodeList.length>0&&this.nodeList.forEach((function(e){0==e.status&&(t=!1)})),t){var e={order:"",lng:"",lat:"",status:0};this.nodeList.push(e),console.log("nodeList",this.nodeList)}else this.$message({type:"warning",message:"请先确认保存上一节点！"})},handleGetNode:function(t){var e=this;console.log("node",t);var i={};i.field_id=this.currentField.field_id,i.order=t.order,i.longitude=t.longitude,i.latitude=t.latitude,t.id?(i.id=t.id,Object(o["o"])(i).then((function(t){200==t.retcode&&(e.$message({type:"success",message:"修改节点成功！"}),e.getNodeList())}))):Object(o["d"])(i).then((function(t){200===t.retcode&&(e.$message({type:"success",message:"新增节点成功！"}),e.getNodeList())}))},handleDelNode:function(t){var e=this;""==t?this.nodeList.splice(this.nodeList.length-1,1):this.nodeList.forEach((function(i,a){i.id==t&&Object(o["h"])({id:i.id}).then((function(t){200==t.retcode&&(e.$message({type:"success",message:"节点已删除！"}),e.getNodeList())}))}))},handleAddBlock:function(){var t=this,e=!0;if(Object.keys(this.postForm).forEach((function(i){console.log(i,t.postForm[i],t.postForm),""!=t.postForm[i]&&void 0!=t.postForm[i]||"fields"===i||"area_name"===i||"time"===i||"smt_id"===i||(e=!1)})),e){var i={timeStamp:(new Date).valueOf(),zone:"",smt_field:"",interval_start:"",interval_end:""};this.blockList.push(i)}else this.$message({type:"warning",message:"请先输入SMT设备信息！"})},handleGetBlock:function(t){this.blockList.forEach((function(e){e.timeStamp===t.timeStamp&&Object.keys(t).forEach((function(i){e[i]=t[i]}))})),console.log(this.blockList)},handleDelBlock:function(t){var e=this;this.blockList.forEach((function(i,a){i.timeStamp?i.timeStamp===t&&e.blockList.splice(a,1):i.smt_field===t&&(e.blockList.splice(a,1),Object(o["g"])({field_id:i.field_id}).then((function(t){200===t.retcode?e.$message({type:"success",message:"删除成功！"}):e.$message({type:"warning",message:"删除失败，".concat(t.status)})})))})),this.$forceUpdate()},handleNode:function(t){this.currentField=t,console.log("field",t),this.showFlag=this.pageType.node,this.getNodeList()}}},$=L,T=(i("57c1"),Object(g["a"])($,a,s,!1,null,"38447cb6",null));e["default"]=T.exports},"8d36":function(t,e,i){"use strict";i.d(e,"a",(function(){return s})),i.d(e,"c",(function(){return o})),i.d(e,"d",(function(){return n})),i.d(e,"b",(function(){return l}));var a=i("b775");function s(t){return Object(a["a"])({url:"/api/v1/area_add/",method:"post",data:t})}function o(t){return Object(a["a"])({url:"/api/v1/area_list/",method:"get",params:t})}function n(t){return Object(a["a"])({url:"/api/v1/area_set/",method:"put",params:t})}function l(t){return Object(a["a"])({url:"/api/v1/area_delete/",method:"delete",params:t})}},"8d41":function(t,e,i){},aa5f:function(t,e,i){"use strict";var a=i("e6b3"),s=i.n(a);s.a},e6b3:function(t,e,i){},f901:function(t,e,i){},fdda:function(t,e,i){"use strict";i.d(e,"a",(function(){return s})),i.d(e,"c",(function(){return o})),i.d(e,"e",(function(){return n})),i.d(e,"b",(function(){return l})),i.d(e,"d",(function(){return r}));var a=i("b775");function s(t){return Object(a["a"])({url:"/api/v1/line_add/",method:"post",data:t})}function o(t){return Object(a["a"])({url:"/api/v1/line_list/",method:"get",params:t})}function n(t){return Object(a["a"])({url:"/api/v1/line_set/",method:"put",params:t})}function l(t){return Object(a["a"])({url:"/api/v1/line_delete/",method:"delete",params:t})}function r(t){return Object(a["a"])({url:"/api/v1/get_detail_response/",method:"get",params:t})}}}]);